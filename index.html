<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <div class="wrap">
      <div class="nav">
        <ul>
          <li><a href="./db.html">DB</a></li>
          <li><a href="./generate.html">Generate</a></li>
          <li><a href="./compare.html">Compare</a></li>
          <li><a href="./timer.html">Timer</a></li>
          <li><a href="./index.html">Soundbar</a></li>
        </ul>
      </div>
      <div class="t_bt">
        <div class="top">
          <h1 id="mosi_32">MOSI : 0000 0000 0000 0000 0000 0000 0000 0000</h1>
          <h1 id="miso_32">MISO : 0000 0000 0000 0000 0000 0000 0000 0000</h1>
        </div>
        <div class="bottom">
          <input id="bit_16">
          <input id="hex_16">
          <br/>
          <br/>
          <table>
            <thead>
              <tr class="first_tr">
                <th style="font-size:12px;">Gubun</th>
                <th>0</th>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
                <th>13</th>
                <th>14</th>
                <th>15</th>
                <th>16</th>
                <th>17</th>
                <th>18</th>
                <th>19</th>
                <th>20</th>
                <th>21</th>
                <th>22</th>
                <th>23</th>
                <th>24</th>
                <th>25</th>
                <th>26</th>
                <th>27</th>
                <th>28</th>
                <th>29</th>
                <th>30</th>
                <th>31</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td class="green">D0</td>
                <td class="green">D1</td>
                <td class="green">D2</td>
                <td class="green">D3</td>
                <td class="green">D4</td>
                <td class="green">D5</td>
                <td class="green">D6</td>
                <td class="green">D7</td>
                <td class="green">D8</td>
                <td class="green">D9</td>
                <td class="green">D10</td>
                <td class="green">D11</td>
                <td class="green">D12</td>
                <td class="green">D13</td>
                <td class="green">D14</td>
                <td class="green">D15</td>
                <td class="pup">A0</td>
                <td class="pup">A1</td>
                <td class="pup">A2</td>
                <td class="pup">A3</td>
                <td class="pup">A4</td>
                <td class="pup">A5</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td class="yellow">W/R</td>
                <td>0</td>
                <td>0</td>
              </tr>
              <tr id="mosi_bit">
                <td>MOSI</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td class="yellow">0</td>
                <td>0</td>
                <td>0</td>
              </tr>
              <tr>
                <td>-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="green">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td class="pup">-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td>-</td>
                <td class="yellow">-</td>
                <td>-</td>
                <td>-</td>
              </tr>
              <tr id="miso_bit">
                <td>MISO</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="green">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td class="pup">0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
                <td class="yellow">0</td>
                <td>0</td>
                <td>0</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="b_cont">
        <div class="bt_wrap">
          <div id="results">
          </div>
        </div>
        <div class="in_cont cont">  
          <div class="cont_wr cont_wr_l">
            <div>
            
            </div>
          </div>
        </div>
        <div class="out_cont cont">
        </div>
      </div>
    </div>
  </body>
</html>
<!-- <script type="text/javascript" src="./index.js"></script> -->
<script> 
  var data;
  var mosi;
  var miso;
  var result="";
  
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      data = JSON.parse(this.responseText);
    }
  };
  xmlhttp.open("GET", "data.txt", true);
  xmlhttp.send();

  (function(){
    document.getElementById("hex_16").addEventListener('keypress', function(e){
      if(e.keyCode==13){
        var dec= document.getElementById('hex_16').value.trim();
        var hex_data="";
        for(var i=0;i<4;i++){
          hex_data += dec.substring(i*2,(i+1)*2)
          // console.log(hex_data)
        }    
        hex_data = parseInt(hex_data,16).toString(2)
        hex_data = addzero(hex_data)
        var hex_bit = ""
        var hex_text =""
        for(var i=0;i<4;i++){
          hex_bit += change(i,hex_data).split("").reverse().join("")
        }
        hex_text = get_addr(hex_bit)
        for(var i=1;i<=32;i++){
          document.getElementById("mosi_bit").getElementsByTagName('td')[i].innerText=hex_bit[i-1]
          document.getElementById("miso_bit").getElementsByTagName('td')[i].innerText=hex_text[i-1]
        }
        document.getElementById("mosi_32").innerText="MISO : " + hex_data.replace(/(.{4})/g,"$1 ").trim();
      }
    })
  })()


  document.getElementById("bit_16").addEventListener('keypress', function(e) {
    if(e.keyCode==13){
      var dec= document.getElementById("bit_16").value.trim();
      var dec_split = dec.split(' ');
      mosi="";
      miso="";
      for(var i=0;i<4;i++){
        mosi+=dec_split[i].substring(0,2);
        miso+=dec_split[i].substring(2,4);
      }
      Substring(miso,1);
      Substring(mosi,0);
    }
  })


  function Substring(num,flag){
    var hex = parseInt(num, 16).toString(2);
      hex=addzero(hex);
      var table_bit = "";
        console.log("num : "+num)
        for(var i=0;i<4;i++){
          var temp = change(i,hex).split("").reverse().join("");
          if(temp.length<4){
            console.log("short!!!")
          }
          table_bit += change(i,hex).split("").reverse().join("");
        }
       console.log("table_bit : "+table_bit)
       if(flag){
        for(var i=1;i<=32;i++){
          document.getElementById("miso_bit").getElementsByTagName('td')[i].innerText=table_bit[i-1]
        }
        document.getElementById("miso_32").innerText="MISO : " + hex.replace(/(.{4})/g,"$1 ").trim();
       }else{
        for(var i=1;i<=32;i++){
          document.getElementById("mosi_bit").getElementsByTagName('td')[i].innerText=table_bit[i-1]
        }
        document.getElementById("mosi_32").innerText="MOSI : " + hex.replace(/(.{4})/g,"$1 ").trim();
       }
      // addr(table_bit);
      // console.log("hi "+table_bit)
      console.log(table_bit)
      // console.log(get_addr(table_bit))
      
      console.log(set_RW(table_bit))
      


      // Interrupts(table_bit);
      // Protocols(table_bit);
      // console.log(result)  //출력
  }
  //Protocol
  function Protocols(num){
    var p_addr = parseInt(get_addr(num),2)
    var p_data = parseInt(get_data(num),2)
    var text = ""
    console.log("p_addr : "+p_addr.toString(16))
    console.log("p_data : "+p_data.toString(16))
    switch (p_addr) {
      case 0x00:
          text += "\tCommand : ";
          if(p_data == 0x00){
            text += "Hello"
          }
          if(p_data == 0x02){
            text += "START PLAY";
          }else if(p_data == 0x03){
            text += "STOP PLAY";
          }else if(p_data == 0x04){
            text += "MUTE OUTPUT";
          }else if(p_data == 0x05){
            text += "RESUME OUTPUT";
          }else if(p_data == 0x06){
            text += "SPORT Reinitialize"
          }else if (p_data == 0x10){
            text += "General Decoding\n"
          }else if (p_data == 0x23){  //AAC
            text += "AAC options\n";
          }else if (p_data == 0x30){  //DDPlus  
            text += "DDPlus options\n"
          }else if (p_data == 0x32){
            text += "TrueHD options\n"
          }else if (p_data == 0x33){
            text += "ATMOS MAT options\n"
          }else if (p_data == 0x35){
            text += "MCPCM options\n"
          }else if (p_data == 0x41){
            text += "Channel Re-Order options\n"
          }else if (p_data == 0x42){
            text += "DAP/OARI options"
          }else if (p_data == 0x50){
            text += "Custom PP\n"
          }
          text += "\n"
          console.log(text)
        break;
      case 0x01:
          text += "\tParameter 1\n"
          text += "\tData : 0x"+p_data+"\n"
          console.log(text)
        break;
      case 0x3c:
          text += "\tGood!!!!\n"
          console.log(text)
      default:
        break;
    }
  }

  function Interrupts(num){ 
    if(!parseInt(num[0])){
      result+=Interrupt_bits0(num);
      result+=Interrupt_bits2_1(num);
      result+=Interrupt_bits3(num);
      result+=Interrupt_bits5_4(num);
    }
    result+=Interrupt_bits9_6(num);
    result+=Interrupt_bits14_10(num);
    result+=Interrupt_bits15(num);
  }

  function Interrupt_bits0(num){
    var mydatas=data.Interrupt[0];
    var addr;
    addr= parseInt(num.substring(0,1));
    var text = "Meaning : "+mydatas[addr].Meaning
    return text;
  }

  function Interrupt_bits2_1(num){
    var mydatas=data.Interrupt[1];
    var addr;
    addr= parseInt(num.substring(1,3),2);
    var text = "Meaning : "+mydatas[addr].Meaning
    return text;
  }
  function Interrupt_bits3(num){
    var mydatas=data.Interrupt[2];
    var addr;
    addr= parseInt(num.substring(3,4),2);
    var text = "Meaning : "+mydatas[addr].Meaning
    return text;
  }
  function Interrupt_bits5_4(num){
    var mydatas=data.Interrupt[3];
    var addr;
    addr= parseInt(num.substring(4,6),2);
    var text = "Meaning : "+mydatas[addr].Meaning
    return text;
  }
  function Interrupt_bits9_6(num){
    var mydatas=data.Interrupt[4];
    var addr;
    addr= parseInt(num.substring(6,10),2);
    var text = "Meaning : "+mydatas.Meaning+"\n"
    return text;
  }
  function Interrupt_bits14_10(num){
    var mydatas=data.Interrupt[4];
    var addr;
    addr= parseInt(num.substring(10,15),2);
    var text = "Meaning : "+mydatas.Meaning
    return text;
  }
  function Interrupt_bits15(num){
    var mydatas=data.Interrupt[4];
    var addr;
    addr= parseInt(num.substring(15,16),2);
    var text = "Meaning : "+mydatas.Meaning
    return text;
  }

  //0추가
  function addzero(num){
    var word= num.toString();
    var str="";
    for(var i=word.length;i<32;i++){
      str+="0";
    }
    return str+word;
  }

  //변경
  function change(index,num){
    var words = "";
    for(var i=index*8;i<8*(index+1);i++){
      words+=num[i];
    }
    return words;
  }

  function addr(num){
    var addr = num.substring(16,22);
    addr = addr.split("").reverse().join("");
    addr = parseInt(addr,2).toString(16)
    console.log(addr)
    return addr
    // if(0<=addr && addr<=63){
    //   var mydatas=data.Command[addr];
      
    //   var text = "Command Buffer Location : "+mydatas.Command_Buffer+ "\nName : "+mydatas.Name+"\nVariable Name in ADSP-21569 : "+mydatas.Variable_Name;
    //     return text;
    //   }
  }

  function convert_bit(num){
    var temp =""
    for(var i=0;i<4;i++){
        if(temp.length<4){
          console.log("short!!!")
        }
      temp += change(i,temp).split("").reverse().join("");
    }
    return table_bit
  }


  //GET && SET



   function set_RW(num){
     console.log((0x01<<2).toString(2))
     return addzero(((parseInt(num,2)&(0x01<<2))>>2).toString(2));
    }
    
    function set_addr(num){
      return addzero(((parseInt(num,2)&0x003f0000)>>16).toString(2));
    }
    
    function set_data(num){
      return addzero((parseInt(num,2)&0x0000ffff).toString(2));
    }
    
    
    function get_RW(){
      console.log("get_RW : ")
      return addzero(temp)
    }
    function get_addr(){
      console.log("get_addr : ")
      return addzero(temp)
    }
    function get_data(){
      console.log("get_data : ")
      return addzero(temp)
    }

  
</script>

<style>
  body{
    margin:0px;
  }
  .wrap{
    width:100%;
    position:relative;
  }
  .t_bt{
    width: 100%;
    text-align: center;
    padding: 20px 0;
  }
  .cont{
    width:50%;
    float: left;
    text-align: center;
  }
  .bottom>table{
    text-align: center;
    margin: 20px auto 10px;
    border-spacing: 0px;
    background: #e2e2e2;
  }
  .bottom>table>tbody>tr>td{
      font-weight:700;
  }
  .first_tr>th{
      font-size: 23px;
      width:42px;
  }
  .green {
      background: #00DF66;
      border-color: #00DF66;
  }
  .pup {
      background-color: #eabdf9;
      border-color: #eabdf9;
  }
  .yellow{
      background-color:yellow;
      border-color: yellow;
  }
  #results span{
    font-size:14px;
    font-weight: 400;
  }
  #results li{
    font-size:16px;
    font-weight: 800;
    list-style: none;
  }
</style>